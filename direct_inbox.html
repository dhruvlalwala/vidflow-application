{% extends 'base.html' %}

{% block content %}
<div class="max-w-2xl mx-auto">
    <h1 class="text-2xl font-bold text-white mb-6">Direct Inbox</h1>

    <div class="bg-black/50 backdrop-blur-xl border border-white/10 shadow-2xl rounded-2xl">
        <ul class="divide-y divide-white/10">
            {% if conversations %}
                {% for convo in conversations %}
                <li class="p-4 hover:bg-white/5 transition duration-200">
                    <a href="{{ url_for('main.messages', username=convo.user.username) }}" class="flex items-center space-x-4">
                        <img src="{{ url_for('static', filename='profile_pics/' + convo.user.profile_pic) }}" alt="{{ convo.user.username }}" class="w-12 h-12 rounded-full object-cover">
                        <div class="flex-1 min-w-0">
                            <p class="font-semibold text-white truncate">{{ convo.user.username }}</p>
                            {% if convo.last_message %}
                            <p class="text-sm text-gray-400 truncate">
                                {% if convo.last_message.sender_id == current_user.id %}You: {% endif %}
                                {{ convo.last_message.text }}
                            </p>
                            {% else %}
                            <p class="text-sm text-gray-400">Start the conversation.</p>
                            {% endif %}
                        </div>
                        {% if convo.last_message %}
                        <div class="text-xs text-gray-500 self-start">
                            {{ convo.last_message.timestamp.strftime('%b %d') }}
                        </div>
                        {% endif %}
                    </a>
                </li>
                {% endfor %}
            {% else %}
                <li class="p-6 text-center text-gray-400">
                    You have no active conversations.
                </li>
            {% endif %}
        </ul>
    </div>
</div>
{% endblock %}
